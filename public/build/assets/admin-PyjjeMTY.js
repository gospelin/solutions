document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("loadingScreen"),y=()=>{l&&(l.style.opacity="0",setTimeout(()=>l.style.display="none",500))};document.readyState==="complete"||document.readyState==="interactive"?setTimeout(y,500):window.addEventListener("load",y);const r=document.getElementById("menuToggle"),d=document.getElementById("sidebar"),m=document.getElementById("overlay");if(r&&d&&m){const e=()=>{d.classList.toggle("active"),r.classList.toggle("active"),m.classList.toggle("active")};r.addEventListener("click",e),m.addEventListener("click",e),document.querySelectorAll(".nav-link, .nav-item button").forEach(t=>{t.addEventListener("click",()=>{window.innerWidth<=1024&&d.classList.contains("active")&&e()})})}else console.warn("Sidebar elements (#menuToggle, #sidebar, #overlay) not found.");const o=document.getElementById("userMenu");o?(o.addEventListener("click",e=>{e.stopPropagation(),o.classList.toggle("active")}),document.addEventListener("click",e=>{!o.contains(e.target)&&o.classList.contains("active")&&o.classList.remove("active")})):console.warn("User menu (#userMenu) not found.");const s=document.getElementById("themeToggle");s?(localStorage.getItem("theme")==="light"?(document.body.classList.add("light"),s.innerHTML='<i class="bi bi-sun"></i>'):s.innerHTML='<i class="bi bi-moon-stars"></i>',s.addEventListener("click",()=>{document.body.classList.toggle("light");const e=document.body.classList.contains("light");s.innerHTML=e?'<i class="bi bi-sun"></i>':'<i class="bi bi-moon-stars"></i>',localStorage.setItem("theme",e?"light":"dark")})):console.warn("Theme toggle (#themeToggle) not found.");const u=document.getElementById("userSearch"),h=document.getElementById("userTableBody");if(u&&h){let e;u.addEventListener("input",()=>{clearTimeout(e),e=setTimeout(()=>{const t=u.value.toLowerCase().trim();Array.from(h.children).forEach(n=>{var L,b,T;const c=((L=n.children[1])==null?void 0:L.textContent.toLowerCase())||"",i=((b=n.children[2])==null?void 0:b.textContent.toLowerCase())||"",v=((T=n.children[3])==null?void 0:T.textContent.toLowerCase())||"";n.style.display=c.includes(t)||i.includes(t)||v.includes(t)?"":"none"})},300)})}else console.warn("User search elements (#userSearch, #userTableBody) not found.");const g=document.getElementById("toolSearch"),f=document.getElementById("toolTableBody");if(g&&f){let e;g.addEventListener("input",()=>{clearTimeout(e),e=setTimeout(()=>{const t=g.value.toLowerCase();Array.from(f.children).forEach(n=>{const c=n.children[0].textContent.toLowerCase(),i=n.children[1].textContent.toLowerCase();n.style.display=c.includes(t)||i.includes(t)?"":"none"})},300)})}else console.warn("Tool search elements (#toolSearch, #toolTableBody) not found.");const a=document.querySelector('form[action*="/admin/profile"]');a&&a.addEventListener("submit",async e=>{e.preventDefault();const t=a.querySelector('button[type="submit"]');t&&(t.disabled=!0);try{const n=new FormData(a),i=await(await fetch(a.action,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:n})).json();alert(i.message||"Profile updated successfully!")}catch(n){console.error("Form submission error:",n),alert("Error updating profile. Please try again.")}finally{t&&(t.disabled=!1)}})});
